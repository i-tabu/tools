<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Password Generator</title>
  <!-- Bootstrap 5.3 CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background: #f8f9fa; }
    .card { border-radius: 1rem; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    .password-box input { font-family: monospace; }
    .toast-container { position: fixed; bottom: 1rem; right: 1rem; z-index: 1055; }
  </style>
</head>
<body>
  <div class="container py-5">
    <div class="card p-4">
      <h3 class="mb-3">Password Generator <small class="text-muted">(Beta)</small></h3>
      <p class="text-muted">These passwords are generated locally in your browser and are not stored or transferred anywhere.</p>

      <div class="mb-3">
        <label for="size" class="form-label">Password size:</label>
        <div class="input-group">
          <button class="btn btn-outline-secondary" type="button" onclick="changeSize(-1)" aria-label="Decrease length">-</button>
          <input type="number" id="size" class="form-control text-center" value="15" min="4" max="64">
          <button class="btn btn-outline-secondary" type="button" onclick="changeSize(1)" aria-label="Increase length">+</button>
          <button class="btn btn-primary" type="button" onclick="generateAll()">Update</button>
        </div>
      </div>

      <div id="passwords" class="mt-3"></div>
    </div>
  </div>

  <!-- Toast container -->
  <div class="toast-container position-fixed bottom-0 end-0 p-3" id="toastArea"></div>

  <!-- Toast container -->
  <div class="toast-container"></div>

  <script>
    function randomPassword(options = {}) {
      if (Object.keys(options).length === 0) {
        options = { smallCase: 1, capitalCase: 0, special: 0, numbers: 1, length: 15 };
      }
      let characterSet = "abcdefghijklmnopqrstuwxyz";
      if (options.capitalCase) characterSet += "ABCDEFGHIJKLMNOPQRSTUWXYZ";
      if (options.numbers) characterSet += "0123456789";
      if (options.special) characterSet += "!@#$%^&*()_-=+;:,.?";

      const out = [];
      for (let i = 0; i < options.length; i++) {
        const n = Math.floor(Math.random() * characterSet.length);
        out.push(characterSet[n]);
      }
      return out.join("");
    }

    function passwordRow(label, options) {
      const password = randomPassword(options);
      const id = Math.random().toString(36).slice(2, 11);
      return `
        <div class="mb-3 password-box">
          <label class="form-label">${label}</label>
          <div class="input-group">
            <input type="text" id="${id}" class="form-control" readonly value="${password}">
            <button type="button" class="btn btn-outline-secondary btn-refresh" data-target="${id}" data-options='${JSON.stringify(options)}' title="Refresh">âŸ³</button>
            <button type="button" class="btn btn-outline-secondary btn-copy" data-target="${id}" title="Copy">ðŸ“‹</button>
          </div>
        </div>`;
    }

    function generateAll() {
      const size = parseInt(document.getElementById("size").value) || 15;
      const container = document.getElementById("passwords");
      container.innerHTML =
        passwordRow("Using all of the character sets:", { smallCase:1, capitalCase:1, numbers:1, special:1, length:size }) +
        passwordRow("Using both the a-z and A-Z character and numbers and special chars:", { smallCase:1, capitalCase:1, numbers:1, special:1, length:size }) +
        passwordRow("Using both the a-z and A-Z character and numbers:", { smallCase:1, capitalCase:1, numbers:1, special:0, length:size }) +
        passwordRow("Using both the a-z and A-Z character sets:", { smallCase:1, capitalCase:1, numbers:0, special:0, length:size }) +
        passwordRow("Using only the A-Z character set:", { smallCase:0, capitalCase:1, numbers:0, special:0, length:size }) +
        passwordRow("Using only the a-z character set:", { smallCase:1, capitalCase:0, numbers:0, special:0, length:size }) +
        passwordRow("Using only the number character set:", { smallCase:0, capitalCase:0, numbers:1, special:0, length:size });
    }

    function changeSize(delta) {
      const sizeInput = document.getElementById("size");
      let size = parseInt(sizeInput.value) || 15;
      size = Math.min(64, Math.max(4, size + delta));
      sizeInput.value = size;
      generateAll();
    }

    async function copyText(text) {
      try {
        await navigator.clipboard.writeText(text);
      } catch (e) {
        // Fallback for older browsers
        const ta = document.createElement('textarea');
        ta.value = text; document.body.appendChild(ta); ta.select();
        document.execCommand('copy'); document.body.removeChild(ta);
      }
    }

    function showToast(message) {
      const area = document.getElementById('toastArea');
      const id = 't_' + Math.random().toString(36).slice(2,7);
      const toastHTML = `
        <div id="${id}" class="toast align-items-center text-bg-success border-0" role="status" aria-live="polite" aria-atomic="true">
          <div class="d-flex">
            <div class="toast-body">${message}</div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
          </div>
        </div>`;
      area.insertAdjacentHTML('beforeend', toastHTML);
      const el = document.getElementById(id);
      const t = new bootstrap.Toast(el, { delay: 1200 });
      t.show();
      el.addEventListener('hidden.bs.toast', () => el.remove());
    }

    function showToast(message) {
      const container = document.querySelector('.toast-container');
      const toast = document.createElement('div');
      toast.className = 'toast align-items-center text-bg-success border-0 show';
      toast.role = 'alert';
      toast.innerHTML = `<div class="d-flex"><div class="toast-body">${message}</div></div>`;
      container.appendChild(toast);
      setTimeout(() => { toast.remove(); }, 2000);
    }

    document.addEventListener('click', (e) => {
      const refreshBtn = e.target.closest('.btn-refresh');
      const copyBtn = e.target.closest('.btn-copy');

      if (refreshBtn) {
        const target = refreshBtn.dataset.target;
        const input = document.getElementById(target);
        const opts = JSON.parse(refreshBtn.dataset.options || '{}');
        const size = parseInt(document.getElementById('size').value) || opts.length || 15;
        opts.length = size;
        input.value = randomPassword(opts);
      }

      if (copyBtn) {
        const target = copyBtn.dataset.target;
        const input = document.getElementById(target);
        copyText(input.value);
        // visual cue on the button
        const originalHTML = copyBtn.innerHTML;
        copyBtn.classList.remove('btn-outline-secondary');
        copyBtn.classList.add('btn-success');
        copyBtn.innerHTML = 'âœ”';
        setTimeout(() => {
          copyBtn.classList.add('btn-outline-secondary');
          copyBtn.classList.remove('btn-success');
          copyBtn.innerHTML = 'ðŸ“‹';
        }, 1000);
        showToast('Password copied');
      }
    });

    generateAll();
  </script>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <footer style="text-align: center; font-size: 0.9em; margin-top: 2em; padding: 1em 0; color: #555;">
    <p>
      <a href="https://tools.itabu.xyz/" style="margin-right: 1em;">Home</a>
      <a href="terms.html" target="_blank" style="margin-right: 1em;">Terms of Service</a>
      <a href="privacy.html" target="_blank">Privacy Policy</a>
    </p>
    <p style="margin-top: 0.5em;">Â© 2025 i-Tabu Tool</p>
  </footer>

</body>
</html>
